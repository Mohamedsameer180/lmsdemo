{"version":3,"sources":["organization.js"],"names":["express","require","router","Router","verifyToken","requireAdmin","upload","get","organizationController","getSettings","body","optional","isLength","min","max","trim","put","isIn","isEmail","matches","isInt","updateSettings","post","module","exports","uploadLogo","getLogo"],"mappings":"aAAA,IAAMA,QAAUC,QAAQ,WAClBC,OAASF,QAAQG,kBADPF,QAAQ,qBAAlBD,cAAAA,eAGgCC,QAAQ,sBAAtCG,sBAAAA,YAAaC,uBAAAA,aAFfH,uBAAND,QAAA,yCAIMK,OAASL,QAAQ,uBAGvBC,OAAOK,IAAI,YAAaH,YAAaI,uBAAuBC,aAG5DP,OARqBG,IASnB,YARFD,YAUEC,aATF,CAWIK,KAAK,QAAQC,WAAWC,SAAS,CAAEC,IAAK,EAAGC,IAAK,MAAOC,OACvDL,KAAK,eAAeC,WAAWC,SAAS,CAAEC,IAAK,GAAIC,IAAK,MAAQC,OATpEb,KAAOK,iBAAiBH,WAAaI,UAAAA,iBAWjCE,KAAK,iBAAiBC,WAAWC,SAAS,CAAEC,IAAK,GAAIC,IAAK,KAR9DZ,KAAOc,YACLL,WACAP,KACAC,CAEwC,MAAL,mBAAA,sBAAA,kBAAa,gBAAE,eAAA,aAAA,gBAAOU,eAClD,qBAA8CD,KAAK,UAAAH,WAAAM,KAAA,CAAA,QAAA,QAAA,QAAA,QAAA,QAAA,QAAA,UAAQF,KAFlE,yBAGwBJ,WAAWO,QAAjC,sCAC4CL,KAAF,2BAAAF,WAAAQ,QAAA,sCAAWL,KAAK,4BAAAH,WAAAQ,QAAA,sCAC1DT,KAAK,qCACIC,WAAAS,MADwB,CACJP,IAAA,EAAAC,IAAA,MAQgCD,KAAF,kCAAAF,WAAAS,MAAA,CAAAP,IAAA,EAAAC,IAAA,MAd7DN,uBAeOa,gBAMTnB,OAAOoB,KAAPpB,QAEEE,YAOFF,aAEAqB,OAAOC,OAAP,QANEhB,uBAAuBiB,YAIzBvB,OAAOK,IAAI,kBAAmBC,uBAAuBkB,SAErDH,OAAOC,QAAUtB","file":"organization.min.js","sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst { body } = require('express-validator');\r\nconst { verifyToken, requireAdmin } = require('../middleware/auth');\r\nconst organizationController = require('../controllers/organizationController');\r\nconst upload = require('../utils/fileUpload');\r\n\r\n// @route   GET /api/organization/settings\r\nrouter.get('/settings', verifyToken, organizationController.getSettings);\r\n\r\n// @route   PUT /api/organization/settings\r\nrouter.put(\r\n  '/settings',\r\n  verifyToken,\r\n  requireAdmin,\r\n  [\r\n    body('name').optional().isLength({ min: 3, max: 100 }).trim(),\r\n    body('description').optional().isLength({ min: 10, max: 1000 }).trim(),\r\n    body('contact.email').optional().isEmail().normalizeEmail(),\r\n    body('contact.phone').optional().isLength({ min: 10, max: 20 }),\r\n    body('timezone').optional().isIn([\r\n      'UTC', 'America/New_York', 'America/Los_Angeles', 'America/Chicago',\r\n      'Europe/London', 'Europe/Paris', 'Asia/Tokyo', 'Asia/Shanghai',\r\n      'Asia/Kolkata', 'Australia/Sydney'\r\n    ]),\r\n    body('locale').optional().isIn(['en-US', 'en-GB', 'es-ES', 'fr-FR', 'de-DE', 'ja-JP', 'zh-CN']),\r\n    body('branding.primaryColor').optional().matches(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/),\r\n    body('branding.secondaryColor').optional().matches(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/),\r\n    body('branding.backgroundColor').optional().matches(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/),\r\n    body('policies.assessmentPassPercentage').optional().isInt({ min: 0, max: 100 }),\r\n    body('policies.assessmentMaxAttempts').optional().isInt({ min: 1, max: 10 })\r\n  ],\r\n  organizationController.updateSettings\r\n);\r\n\r\n// @route   POST /api/organization/logo\r\nrouter.post(\r\n  '/logo',\r\n  verifyToken,\r\n  requireAdmin,\r\n  upload.single('logo'),\r\n  organizationController.uploadLogo\r\n);\r\n\r\n// @route   GET /api/organization/logo/:filename\r\nrouter.get('/logo/:filename', organizationController.getLogo);\r\n\r\nmodule.exports = router;"]}