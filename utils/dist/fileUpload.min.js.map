{"version":3,"sources":["fileUpload.js"],"names":["multer","require","path","uploadDir","process","env","UPLOAD_PATH","fs","existsSync","mkdirSync","recursive","cb","filename","req","file","storage","Date","now","Math","round","random","extname","originalname","fileFilter","uniqueSuffix","ext","allowedTypes","toLowerCase","mimetype","test","upload","limits","fileSize","parseInt","MAX_LOGO_SIZE"],"mappings":"aAAA,IAAMA,OAASC,QAAQ,UACjBC,KAAOD,QAAQ,QADfD,GAAMC,QAAGA,MAKTE,UAAYC,QAAQC,IAAIC,aAAe,kBAHvCC,GAAEC,WAAWL,YAKjBI,GAAGE,UAAUN,UAAW,CAAEO,WAAW,IADvC,IAAKH,QAAGC,OAAWL,YAAY,CAC7BI,YAAaJ,SAAAA,EAAAA,EAAWQ,GAAED,EAAAA,KAASP,YAGrCS,SAAA,SAAAC,EAAAC,EAAAH,GACMI,EAAAA,KAAO,SAKYC,KAAKC,MAAQ,IAAMC,KAAKC,MAAsB,IAAhBD,KAAKE,WAC5ClB,KAAKmB,QAAQP,EAAKQ,kBAD9BC,WAAMC,SAAYX,EAAGG,EAAAL,GACrB,IAAMc,EAAWJ,uBACdA,EAAMK,EAAUF,KAAVtB,KAAPmB,QAAFP,EAAAQ,cAAAK,eACDC,EAAAF,EAAAG,KAAAf,EAAAc,UASD,GAAIP,GAAWO,EALXL,OAAAA,EAAU,MAAG,GAEjBZ,EAAA,IAAMU,MAAO,6DAIXS,OAAU9B,OAAM,CACjBe,QAAAA,QAODgB,OAAQ,CANNC,SAACC,SAAU7B,QAAAC,IAAA6B,gBAAA,SASbX,WAAAA,aAJAR,OAAAA,QAAAA","file":"fileUpload.min.js","sourcesContent":["const multer = require('multer');\r\nconst path = require('path');\r\nconst fs = require('fs');\r\n\r\n// Ensure upload directory exists\r\nconst uploadDir = process.env.UPLOAD_PATH || './uploads/logos';\r\nif (!fs.existsSync(uploadDir)) {\r\n  fs.mkdirSync(uploadDir, { recursive: true });\r\n}\r\n\r\n// Configure Multer storage\r\nconst storage = multer.diskStorage({\r\n  destination: (req, file, cb) => {\r\n    cb(null, uploadDir);\r\n  },\r\n  filename: (req, file, cb) => {\r\n    const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);\r\n    const ext = path.extname(file.originalname);\r\n    cb(null, 'logo-' + uniqueSuffix + ext);\r\n  }\r\n});\r\n\r\n// File filter for images only\r\nconst fileFilter = (req, file, cb) => {\r\n  const allowedTypes = /jpeg|jpg|png|gif|svg/;\r\n  const extname = allowedTypes.test(path.extname(file.originalname).toLowerCase());\r\n  const mimetype = allowedTypes.test(file.mimetype);\r\n  \r\n  if (extname && mimetype) {\r\n    return cb(null, true);\r\n  }\r\n  cb(new Error('Only image files (JPEG, JPG, PNG, GIF, SVG) are allowed'));\r\n};\r\n\r\n// Multer upload configuration\r\nconst upload = multer({\r\n  storage,\r\n  limits: {\r\n    fileSize: parseInt(process.env.MAX_LOGO_SIZE) || 2 * 1024 * 1024 // 2MB default\r\n  },\r\n  fileFilter\r\n});\r\n\r\nmodule.exports = upload;"]}