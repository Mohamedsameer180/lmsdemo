{"version":3,"sources":["fileUpload.js"],"names":["multer","require","path","fs","uploadDir","process","env","UPLOAD_PATH","existsSync","mkdirSync","recursive","storage","diskStorage","destination","req","file","cb","filename","uniqueSuffix","Date","now","Math","round","random","ext","extname","originalname","fileFilter","allowedTypes","test","toLowerCase","mimetype","Error","upload","limits","fileSize","parseInt","MAX_LOGO_SIZE","module","exports"],"mappings":";;AAAA,IAAMA,MAAM,GAAGC,OAAO,CAAC,QAAD,CAAtB;;AACA,IAAMC,IAAI,GAAGD,OAAO,CAAC,MAAD,CAApB;;AACA,IAAME,EAAE,GAAGF,OAAO,CAAC,IAAD,CAAlB,C,CAEA;;;AACA,IAAMG,SAAS,GAAGC,OAAO,CAACC,GAAR,CAAYC,WAAZ,IAA2B,iBAA7C;;AACA,IAAI,CAACJ,EAAE,CAACK,UAAH,CAAcJ,SAAd,CAAL,EAA+B;AAC7BD,EAAAA,EAAE,CAACM,SAAH,CAAaL,SAAb,EAAwB;AAAEM,IAAAA,SAAS,EAAE;AAAb,GAAxB;AACD,C,CAED;;;AACA,IAAMC,OAAO,GAAGX,MAAM,CAACY,WAAP,CAAmB;AACjCC,EAAAA,WAAW,EAAE,qBAACC,GAAD,EAAMC,IAAN,EAAYC,EAAZ,EAAmB;AAC9BA,IAAAA,EAAE,CAAC,IAAD,EAAOZ,SAAP,CAAF;AACD,GAHgC;AAIjCa,EAAAA,QAAQ,EAAE,kBAACH,GAAD,EAAMC,IAAN,EAAYC,EAAZ,EAAmB;AAC3B,QAAME,YAAY,GAAGC,IAAI,CAACC,GAAL,KAAa,GAAb,GAAmBC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,GAA3B,CAAxC;AACA,QAAMC,GAAG,GAAGtB,IAAI,CAACuB,OAAL,CAAaV,IAAI,CAACW,YAAlB,CAAZ;AACAV,IAAAA,EAAE,CAAC,IAAD,EAAO,UAAUE,YAAV,GAAyBM,GAAhC,CAAF;AACD;AARgC,CAAnB,CAAhB,C,CAWA;;AACA,IAAMG,UAAU,GAAG,SAAbA,UAAa,CAACb,GAAD,EAAMC,IAAN,EAAYC,EAAZ,EAAmB;AACpC,MAAMY,YAAY,GAAG,sBAArB;AACA,MAAMH,OAAO,GAAGG,YAAY,CAACC,IAAb,CAAkB3B,IAAI,CAACuB,OAAL,CAAaV,IAAI,CAACW,YAAlB,EAAgCI,WAAhC,EAAlB,CAAhB;AACA,MAAMC,QAAQ,GAAGH,YAAY,CAACC,IAAb,CAAkBd,IAAI,CAACgB,QAAvB,CAAjB;;AAEA,MAAIN,OAAO,IAAIM,QAAf,EAAyB;AACvB,WAAOf,EAAE,CAAC,IAAD,EAAO,IAAP,CAAT;AACD;;AACDA,EAAAA,EAAE,CAAC,IAAIgB,KAAJ,CAAU,yDAAV,CAAD,CAAF;AACD,CATD,C,CAWA;;;AACA,IAAMC,MAAM,GAAGjC,MAAM,CAAC;AACpBW,EAAAA,OAAO,EAAPA,OADoB;AAEpBuB,EAAAA,MAAM,EAAE;AACNC,IAAAA,QAAQ,EAAEC,QAAQ,CAAC/B,OAAO,CAACC,GAAR,CAAY+B,aAAb,CAAR,IAAuC,IAAI,IAAJ,GAAW,IADtD,CAC2D;;AAD3D,GAFY;AAKpBV,EAAAA,UAAU,EAAVA;AALoB,CAAD,CAArB;AAQAW,MAAM,CAACC,OAAP,GAAiBN,MAAjB","sourcesContent":["const multer = require('multer');\r\nconst path = require('path');\r\nconst fs = require('fs');\r\n\r\n// Ensure upload directory exists\r\nconst uploadDir = process.env.UPLOAD_PATH || './uploads/logos';\r\nif (!fs.existsSync(uploadDir)) {\r\n  fs.mkdirSync(uploadDir, { recursive: true });\r\n}\r\n\r\n// Configure Multer storage\r\nconst storage = multer.diskStorage({\r\n  destination: (req, file, cb) => {\r\n    cb(null, uploadDir);\r\n  },\r\n  filename: (req, file, cb) => {\r\n    const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);\r\n    const ext = path.extname(file.originalname);\r\n    cb(null, 'logo-' + uniqueSuffix + ext);\r\n  }\r\n});\r\n\r\n// File filter for images only\r\nconst fileFilter = (req, file, cb) => {\r\n  const allowedTypes = /jpeg|jpg|png|gif|svg/;\r\n  const extname = allowedTypes.test(path.extname(file.originalname).toLowerCase());\r\n  const mimetype = allowedTypes.test(file.mimetype);\r\n  \r\n  if (extname && mimetype) {\r\n    return cb(null, true);\r\n  }\r\n  cb(new Error('Only image files (JPEG, JPG, PNG, GIF, SVG) are allowed'));\r\n};\r\n\r\n// Multer upload configuration\r\nconst upload = multer({\r\n  storage,\r\n  limits: {\r\n    fileSize: parseInt(process.env.MAX_LOGO_SIZE) || 2 * 1024 * 1024 // 2MB default\r\n  },\r\n  fileFilter\r\n});\r\n\r\nmodule.exports = upload;"],"file":"fileUpload.dev.js"}