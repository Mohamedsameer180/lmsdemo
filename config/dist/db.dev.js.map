{"version":3,"sources":["db.js"],"names":["mongoose","require","connectDB","connect","process","env","MONGODB_URI","useNewUrlParser","useUnifiedTopology","conn","console","log","connection","host","Organization","findOne","existingOrg","defaultOrg","name","description","contact","email","phone","address","branding","primaryColor","secondaryColor","backgroundColor","fontFamily","policies","courseAccess","assessmentPassPercentage","assessmentMaxAttempts","certificationValidityMonths","certificationRenewalRequired","learningDeadlineDays","complianceRequired","save","error","message","exit","module","exports"],"mappings":";;AAAA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEA,IAAMC,SAAS,GAAG,SAAZA,SAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAEKF,QAAQ,CAACG,OAAT,CAAiBC,OAAO,CAACC,GAAR,CAAYC,WAA7B,EAA0C;AAC3DC,YAAAA,eAAe,EAAE,IAD0C;AAE3DC,YAAAA,kBAAkB,EAAE;AAFuC,WAA1C,CAFL;;AAAA;AAERC,UAAAA,IAFQ;AAOdC,UAAAA,OAAO,CAACC,GAAR,qCAAoCF,IAAI,CAACG,UAAL,CAAgBC,IAApD,GAPc,CASd;;AACMC,UAAAA,YAVQ,GAUOb,OAAO,CAAC,wBAAD,CAVd;AAAA;AAAA,0CAWYa,YAAY,CAACC,OAAb,EAXZ;;AAAA;AAWRC,UAAAA,WAXQ;;AAAA,cAaTA,WAbS;AAAA;AAAA;AAAA;;AAcNC,UAAAA,UAdM,GAcO,IAAIH,YAAJ,CAAiB;AAClCI,YAAAA,IAAI,EAAE,sBAD4B;AAElCC,YAAAA,WAAW,EAAE,kCAFqB;AAGlCC,YAAAA,OAAO,EAAE;AACPC,cAAAA,KAAK,EAAE,mBADA;AAEPC,cAAAA,KAAK,EAAE,aAFA;AAGPC,cAAAA,OAAO,EAAE;AAHF,aAHyB;AAQlCC,YAAAA,QAAQ,EAAE;AACRC,cAAAA,YAAY,EAAE,SADN;AAERC,cAAAA,cAAc,EAAE,SAFR;AAGRC,cAAAA,eAAe,EAAE,SAHT;AAIRC,cAAAA,UAAU,EAAE;AAJJ,aARwB;AAclCC,YAAAA,QAAQ,EAAE;AACRC,cAAAA,YAAY,EAAE,YADN;AAERC,cAAAA,wBAAwB,EAAE,EAFlB;AAGRC,cAAAA,qBAAqB,EAAE,CAHf;AAIRC,cAAAA,2BAA2B,EAAE,EAJrB;AAKRC,cAAAA,4BAA4B,EAAE,IALtB;AAMRC,cAAAA,oBAAoB,EAAE,EANd;AAORC,cAAAA,kBAAkB,EAAE;AAPZ;AAdwB,WAAjB,CAdP;AAAA;AAAA,0CAuCNnB,UAAU,CAACoB,IAAX,EAvCM;;AAAA;AAwCZ3B,UAAAA,OAAO,CAACC,GAAR,CAAY,yCAAZ;;AAxCY;AAAA;AAAA;;AAAA;AAAA;AAAA;AA2CdD,UAAAA,OAAO,CAAC4B,KAAR,kCAAmC,YAAMC,OAAzC;AACAnC,UAAAA,OAAO,CAACoC,IAAR,CAAa,CAAb;;AA5Cc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAlB;;AAgDAC,MAAM,CAACC,OAAP,GAAiBxC,SAAjB","sourcesContent":["const mongoose = require('mongoose');\r\n\r\nconst connectDB = async () => {\r\n  try {\r\n    const conn = await mongoose.connect(process.env.MONGODB_URI, {\r\n      useNewUrlParser: true,\r\n      useUnifiedTopology: true,\r\n    });\r\n    \r\n    console.log(`✅ MongoDB Connected: ${conn.connection.host}`);\r\n    \r\n    // Initialize default organization settings if none exist\r\n    const Organization = require('../models/Organization');\r\n    const existingOrg = await Organization.findOne();\r\n    \r\n    if (!existingOrg) {\r\n      const defaultOrg = new Organization({\r\n        name: 'Default Organization',\r\n        description: 'Update your organization details',\r\n        contact: {\r\n          email: 'admin@example.com',\r\n          phone: '+1234567890',\r\n          address: '123 Main St, City, Country'\r\n        },\r\n        branding: {\r\n          primaryColor: '#1976d2',\r\n          secondaryColor: '#dc004e',\r\n          backgroundColor: '#f5f5f5',\r\n          fontFamily: 'Roboto, sans-serif'\r\n        },\r\n        policies: {\r\n          courseAccess: 'role-based',\r\n          assessmentPassPercentage: 70,\r\n          assessmentMaxAttempts: 3,\r\n          certificationValidityMonths: 12,\r\n          certificationRenewalRequired: true,\r\n          learningDeadlineDays: 30,\r\n          complianceRequired: false\r\n        }\r\n      });\r\n      \r\n      await defaultOrg.save();\r\n      console.log('✅ Default organization settings created');\r\n    }\r\n  } catch (error) {\r\n    console.error(`❌ Database Error: ${error.message}`);\r\n    process.exit(1);\r\n  }\r\n};\r\n\r\nmodule.exports = connectDB;"],"file":"db.dev.js"}