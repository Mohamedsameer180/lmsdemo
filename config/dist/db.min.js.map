{"version":3,"sources":["db.js"],"names":["mongoose","require","connectDB","process","env","MONGODB_URI","useNewUrlParser","useUnifiedTopology","console","log","concat","conn","connection","host","Organization","findOne","defaultOrg","name","email","address","branding","primaryColor","existingOrg","backgroundColor","fontFamily","policies","courseAccess","assessmentPassPercentage","description","contact","save","_context","t0","message","exit","assessmentMaxAttempts"],"mappings":"aAAA,IAAMA,SAAWC,QAAQ,YAAnBD,UAAWC,WAAAA,IAAAA,EAAAA,EAAAA,EAAAA,OAAAA,mBAAAA,MAAAA,SAAAA,GAAAA,OAAAA,OAAAA,EAAAA,KAAAA,EAAAA,MAAAA,KAAAA,EAAAA,OAAAA,EAAAA,KAAAA,EAAAA,EAAAA,KAAAA,EAAAA,mBAAAA,MAECD,SAAZE,QAAYC,QAAAC,IAAAC,YAAA,CAAAC,iBAAA,EAAAC,oBAAA,KAFDN,KAAAA,EAAAA,OAEXC,EAFWD,EAAAA,KAECO,QAAAC,IAAA,wBAAAC,OAAAC,EAAAC,WAAAC,OAAAC,EAAAb,QAAA,0BAFDA,EAAAA,KAAAA,EAAAA,mBAAAA,MAKMa,EAD0CC,WAJhDd,KAAAA,EAAAA,GAAAA,EAAAA,KAAAA,CAAAA,EAAAA,KAAAA,GAAAA,MAAAA,OAgBLe,EAAa,IAAIF,EAAa,CAdxBG,KAAA,uBAERN,YAFQ,mCAOdH,QAAO,CAWDU,MAAO,oBARPJ,MAAAA,cAVQK,QAAA,8BAsBVC,SAAU,CAtBAC,aAAA,UAWRC,eAXQ,UAyBRC,gBAAiB,UAzBTC,WAaTF,sBAbSG,SAAA,CAAAC,aAAA,aA8BRC,yBAA0B,GAhBxBX,sBAAiBF,EACrBG,4BAAM,GACNW,8BAAa,EACbC,qBAAS,GACPX,oBAAO,KApBAjB,EAAAA,KAAAA,GAAAA,mBAAAA,MAwBTmB,EAAUU,QAxBD7B,KAAAA,GAyBPoB,QAAAA,IAAAA,2CAzBOpB,KAAAA,GAAAA,EAAAA,KAAAA,GAAAA,MAAAA,KAAAA,GAAAA,EAAAA,KAAAA,GAAAA,EAAAA,GAAAA,EAAAA,MAAAA,GA4BPuB,QAAAA,MAAAA,qBAAAA,OAAYO,EAAAC,GAAAC,UAJJ9B,QAAA+B,KARwB,GAhBzBjC,KAAAA,GAAAA,IAAAA,MAAAA,OAAAA,EAAAA,SAAAA,KAAAA,KAAAA,CAAAA,CAAAA,EAAAA,OAiCPkC,OAAAA,QAAAA","file":"db.min.js","sourcesContent":["const mongoose = require('mongoose');\r\n\r\nconst connectDB = async () => {\r\n  try {\r\n    const conn = await mongoose.connect(process.env.MONGODB_URI, {\r\n      useNewUrlParser: true,\r\n      useUnifiedTopology: true,\r\n    });\r\n    \r\n    console.log(`✅ MongoDB Connected: ${conn.connection.host}`);\r\n    \r\n    // Initialize default organization settings if none exist\r\n    const Organization = require('../models/Organization');\r\n    const existingOrg = await Organization.findOne();\r\n    \r\n    if (!existingOrg) {\r\n      const defaultOrg = new Organization({\r\n        name: 'Default Organization',\r\n        description: 'Update your organization details',\r\n        contact: {\r\n          email: 'admin@example.com',\r\n          phone: '+1234567890',\r\n          address: '123 Main St, City, Country'\r\n        },\r\n        branding: {\r\n          primaryColor: '#1976d2',\r\n          secondaryColor: '#dc004e',\r\n          backgroundColor: '#f5f5f5',\r\n          fontFamily: 'Roboto, sans-serif'\r\n        },\r\n        policies: {\r\n          courseAccess: 'role-based',\r\n          assessmentPassPercentage: 70,\r\n          assessmentMaxAttempts: 3,\r\n          certificationValidityMonths: 12,\r\n          certificationRenewalRequired: true,\r\n          learningDeadlineDays: 30,\r\n          complianceRequired: false\r\n        }\r\n      });\r\n      \r\n      await defaultOrg.save();\r\n      console.log('✅ Default organization settings created');\r\n    }\r\n  } catch (error) {\r\n    console.error(`❌ Database Error: ${error.message}`);\r\n    process.exit(1);\r\n  }\r\n};\r\n\r\nmodule.exports = connectDB;"]}